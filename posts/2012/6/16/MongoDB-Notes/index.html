<!DOCTYPE html>
<head>
  <meta charset="utf-8"/>
  <title>MongoDB Notes &mdash; Data, ML &amp; Management</title>

  <link type="text/css" rel="stylesheet" href="/static/sdist/ff9ec00429d34a18995915040b9b5bf9.css">

  <script type="text/javascript" src="/static/sdist/aa45836fe5eaf91e9c964fd639fa3c1f.js"></script>

  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"type="text/javascript"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
      }
    });
  </script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel='shortcut icon' href="/static/favicon.ico" type='image/x-icon'/>
  <style type="text/css">
   img { mix-blend-mode: multiply; }
  </style>
  <meta property="og:author" content="Bugra Akyildiz" />
  <meta property="og:title" content="MongoDB Notes" />
  <meta property="og:type" content="website" />
  <meta property="og:description" content="" />
  <meta property="og:url" content="https://bugra.github.io/posts/2012/6/16/MongoDB-Notes/" />
  <meta property="og:image" content="/static/img/athena.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="MongoDB Notes" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:url" content="https://bugra.github.io/posts/2012/6/16/MongoDB-Notes/" />
  <meta name="twitter:image" content="/static/img/athena.png" />
</head>
<body>
    <div class="marginnote">
        <div id="logo"><a href="/" class="at"></a></div>
    </div>
  <div class="thearticle">
  
  <article>
  
    <h1>MongoDB Notes</h1>
    <p id="blog-p"><span id="blogdesc" class="marginnote">
    <br><br>
    <a href="/">home</a> ·
    
      <a href="/about/">
        about</a> ·
    
    <a href="/feed.atom">subscribe</a></span></p>

    <subtitle class="sub-date">June 16, 2012 · <span
    style="font-size: 1.6rem;"><a style="border-bottom-width: 0px !important;"
    href="https://bugra.github.io/posts/2012/6/16/MongoDB-Notes/">&infin;</a></span></subtitle>

    <!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Untitled</title>
  <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style>
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h3 id="some-properties">Some Properties</h3>
<ul>
<li>MongoDB instances act as high-level container.</li>
<li><em>Collection</em> is a synonym of table in sql.</li>
<li>Collections are made by <em>documents</em>. (document =&gt; row)</li>
<li>Document is made by <em>fields</em>. (field =&gt; column)</li>
<li>Indices are similar to sql databases.</li>
<li>Cursor can count or skip ahead without actually pulling down data.</li>
</ul>
<blockquote>
<p>A collection does not have a schema to follow. Therefore, fields are tracked with each individual document.</p>
</blockquote>
<blockquote>
<p>_id field is automatically generated by MongoDB, and every document must have a unique _id field.</p>
</blockquote>
<h3 id="adding-queries">Adding queries</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1"></a><span class="va">db</span>.<span class="va">matrix</span>.<span class="at">insert</span>(<span class="op">{</span><span class="dt">name </span><span class="op">:</span> <span class="st">&#39;Agent Smith&#39;</span><span class="op">,</span> <span class="dt">gender </span><span class="op">:</span> <span class="st">&#39;m&#39;</span><span class="op">,</span> <span class="dt">age </span><span class="op">:</span> <span class="dv">44</span><span class="op">}</span>)</span></code></pre></div>
<p>and <code>db.matrix.findOne()</code> results in;</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1"></a><span class="op">{</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>    <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcf8b5321f61bf6f63ddd78&quot;</span>)<span class="op">,</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>    <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Agent Smith&quot;</span><span class="op">,</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>    <span class="st">&quot;gender&quot;</span> <span class="op">:</span> <span class="st">&quot;m&quot;</span><span class="op">,</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>    <span class="st">&quot;age&quot;</span> <span class="op">:</span> <span class="dv">44</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="op">}</span></span></code></pre></div>
<p>If we add another person:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1"></a><span class="va">db</span>.<span class="va">matrix</span>.<span class="at">insert</span>(<span class="op">{</span><span class="dt">name </span><span class="op">:</span> <span class="st">&#39;Neo&#39;</span><span class="op">,</span> <span class="dt">gender </span><span class="op">:</span> <span class="st">&#39;m&#39;</span><span class="op">,</span> <span class="dt">age </span><span class="op">:</span> <span class="dv">40</span><span class="op">}</span>)</span></code></pre></div>
<p>and call <code>db.matrix.find()</code> then we get;</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcf8b5321f61bf6f63ddd78&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Agent Smith&quot;</span><span class="op">,</span> <span class="st">&quot;gender&quot;</span> <span class="op">:</span> <span class="st">&quot;m&quot;</span><span class="op">,</span> <span class="st">&quot;age&quot;</span> <span class="op">:</span> <span class="dv">44</span> <span class="op">}</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcf8ce921f61bf6f63ddd79&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Neo&quot;</span><span class="op">,</span> <span class="st">&quot;gender&quot;</span> <span class="op">:</span> <span class="st">&quot;m&quot;</span><span class="op">,</span> <span class="st">&quot;age&quot;</span> <span class="op">:</span> <span class="dv">40</span> <span class="op">}</span></span></code></pre></div>
<p>Similarly add two more people:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1"></a><span class="va">db</span>.<span class="va">matrix</span>.<span class="at">insert</span>(<span class="op">{</span><span class="dt">name </span><span class="op">:</span> <span class="st">&#39;Trinity&#39;</span><span class="op">,</span> <span class="dt">gender </span><span class="op">:</span> <span class="st">&#39;f&#39;</span><span class="op">,</span> <span class="dt">age </span><span class="op">:</span> <span class="dv">35</span><span class="op">}</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="va">db</span>.<span class="va">matrix</span>.<span class="at">insert</span>(<span class="op">{</span><span class="dt">name </span><span class="op">:</span> <span class="st">&#39;Morpheus&#39;</span><span class="op">,</span> <span class="dt">gender </span><span class="op">:</span> <span class="st">&#39;m&#39;</span><span class="op">,</span> <span class="dt">age </span><span class="op">:</span> <span class="dv">45</span><span class="op">}</span>)</span></code></pre></div>
<p>And we have total of four people in the database and we could print by using <code>find()</code> method as <code>db.matrix.find()</code> and return the list of <em>documents</em>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcf8b5321f61bf6f63ddd78&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Agent Smith&quot;</span><span class="op">,</span> <span class="st">&quot;gender&quot;</span> <span class="op">:</span> <span class="st">&quot;m&quot;</span><span class="op">,</span> <span class="st">&quot;age&quot;</span> <span class="op">:</span> <span class="dv">44</span> <span class="op">}</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcf8ce921f61bf6f63ddd79&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Neo&quot;</span><span class="op">,</span> <span class="st">&quot;gender&quot;</span> <span class="op">:</span> <span class="st">&quot;m&quot;</span><span class="op">,</span> <span class="st">&quot;age&quot;</span> <span class="op">:</span> <span class="dv">40</span> <span class="op">}</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcf8df921f61bf6f63ddd7a&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Trinity&quot;</span><span class="op">,</span> <span class="st">&quot;gender&quot;</span> <span class="op">:</span> <span class="st">&quot;f&quot;</span><span class="op">,</span> <span class="st">&quot;age&quot;</span> <span class="op">:</span> <span class="dv">35</span> <span class="op">}</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcf8e0821f61bf6f63ddd7b&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Morpheus&quot;</span><span class="op">,</span> <span class="st">&quot;gender&quot;</span> <span class="op">:</span> <span class="st">&quot;m&quot;</span><span class="op">,</span> <span class="st">&quot;age&quot;</span> <span class="op">:</span> <span class="dv">45</span> <span class="op">}</span></span></code></pre></div>
<p>Architecture seems to be male, but he is considered to be ageless. Therefore, when we insert the document in database, we <em>can</em> simply ignore his age information as such:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1"></a><span class="va">db</span>.<span class="va">matrix</span>.<span class="at">insert</span>(<span class="op">{</span><span class="dt">name </span><span class="op">:</span> <span class="st">&#39;Architecture&#39;</span><span class="op">,</span> <span class="dt">gender </span><span class="op">:</span> <span class="st">&#39;m&#39;</span><span class="op">}</span>)</span></code></pre></div>
<p>and when we return documents, mongo would not cause any problem at all.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcf8b5321f61bf6f63ddd78&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Agent Smith&quot;</span><span class="op">,</span> <span class="st">&quot;gender&quot;</span> <span class="op">:</span> <span class="st">&quot;m&quot;</span><span class="op">,</span> <span class="st">&quot;age&quot;</span> <span class="op">:</span> <span class="dv">44</span> <span class="op">}</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcf8ce921f61bf6f63ddd79&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Neo&quot;</span><span class="op">,</span> <span class="st">&quot;gender&quot;</span> <span class="op">:</span> <span class="st">&quot;m&quot;</span><span class="op">,</span> <span class="st">&quot;age&quot;</span> <span class="op">:</span> <span class="dv">40</span> <span class="op">}</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcf8df921f61bf6f63ddd7a&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Trinity&quot;</span><span class="op">,</span> <span class="st">&quot;gender&quot;</span> <span class="op">:</span> <span class="st">&quot;f&quot;</span><span class="op">,</span> <span class="st">&quot;age&quot;</span> <span class="op">:</span> <span class="dv">35</span> <span class="op">}</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcf8e0821f61bf6f63ddd7b&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Morpheus&quot;</span><span class="op">,</span> <span class="st">&quot;gender&quot;</span> <span class="op">:</span> <span class="st">&quot;m&quot;</span><span class="op">,</span> <span class="st">&quot;age&quot;</span> <span class="op">:</span> <span class="dv">45</span> <span class="op">}</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcfa18821f61bf6f63ddd7c&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Architecture&quot;</span><span class="op">,</span> <span class="st">&quot;gender&quot;</span> <span class="op">:</span> <span class="st">&quot;m&quot;</span> <span class="op">}</span></span></code></pre></div>
<hr />
<p>After creating the database, we need to be able to select some queries based on their fields. In order to do it, we need to use <em>selectors</em> which are very similart to <strong>where</strong> clause of Sql statement. simplest one is <code>{}</code> which returns all documents in the collection. <code>null</code> also does the same thing as such:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1"></a><span class="va">db</span>.<span class="va">matrix</span>.<span class="at">find</span>(<span class="op">{}</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="va">db</span>.<span class="va">matrix</span>.<span class="at">find</span>(<span class="kw">null</span>)</span></code></pre></div>
<p>returns all the documents in the collection. <code>and</code> statement is accomplished in the form of:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1"></a><span class="op">{</span><span class="dt">field1 </span><span class="op">:</span> value1<span class="op">,</span> <span class="dt">field2 </span><span class="op">:</span> value2<span class="op">}</span></span></code></pre></div>
<p>which is very intuitive. In this example, if we want to return males whose ages are more or equal to 44, then we need to write a selector as such:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1"></a><span class="va">db</span>.<span class="va">matrix</span>.<span class="at">find</span>(<span class="op">{</span><span class="dt">gender</span><span class="op">:</span> <span class="st">&#39;m&#39;</span><span class="op">,</span> <span class="dt">age</span><span class="op">:</span> <span class="op">{</span><span class="dt">$gte</span><span class="op">:</span> <span class="dv">44</span><span class="op">}}</span>)</span></code></pre></div>
<p>Some of common operations are: <code>\(lt</code> =&gt; less than <code>\(lte</code>=&gt; less or equal <code>\(gt</code>=&gt; greater than <code>\(gte</code>=&gt; greater or equal <code>\(ne</code> =&gt; not equal</p>
<p>If we take harder example like a field defines an array, in a particular example, let it be sports which students like, create the database as such:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcfce79fd6230c28d817740&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;john&quot;</span><span class="op">,</span> <span class="st">&quot;likes&quot;</span> <span class="op">:</span> [ <span class="st">&quot;basketball&quot;</span><span class="op">,</span> <span class="st">&quot;football&quot;</span><span class="op">,</span> <span class="st">&quot;baseball&quot;</span><span class="op">,</span> <span class="st">&quot;swimming&quot;</span> ] <span class="op">}</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcfcf02fd6230c28d817742&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;mike&quot;</span><span class="op">,</span> <span class="st">&quot;likes&quot;</span> <span class="op">:</span> [ <span class="st">&quot;basketball&quot;</span><span class="op">,</span> <span class="st">&quot;football&quot;</span><span class="op">,</span> <span class="st">&quot;tennis&quot;</span><span class="op">,</span> <span class="st">&quot;rugby&quot;</span> ] <span class="op">}</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcfcf08fd6230c28d817743&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;cassandra&quot;</span><span class="op">,</span> <span class="st">&quot;likes&quot;</span> <span class="op">:</span> [ <span class="st">&quot;golf&quot;</span><span class="op">,</span> <span class="st">&quot;table-tennis&quot;</span><span class="op">,</span> <span class="st">&quot;tennis&quot;</span> ] <span class="op">}</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcfcf11fd6230c28d817744&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;paul&quot;</span><span class="op">,</span> <span class="st">&quot;likes&quot;</span> <span class="op">:</span> [ <span class="st">&quot;golf&quot;</span><span class="op">,</span> <span class="st">&quot;table-tennis&quot;</span><span class="op">,</span> <span class="st">&quot;tennis&quot;</span><span class="op">,</span> <span class="st">&quot;rugby&quot;</span> ] <span class="op">}</span></span></code></pre></div>
<p>If we would like to retrieve students who likes golf or tennis:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb13-1"><a href="#cb13-1"></a><span class="va">db</span>.<span class="va">students</span>.<span class="at">find</span>(<span class="op">{</span><span class="dt">$or </span><span class="op">:</span> [<span class="op">{</span><span class="dt">likes </span><span class="op">:</span> <span class="st">&#39;tennis&#39;</span><span class="op">},{</span><span class="dt">likes </span><span class="op">:</span> <span class="st">&#39;golf&#39;</span><span class="op">}</span>]<span class="op">}</span>)</span></code></pre></div>
<p>Then we get queries;</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb14-1"><a href="#cb14-1"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcfcf02fd6230c28d817742&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;mike&quot;</span><span class="op">,</span> <span class="st">&quot;likes&quot;</span> <span class="op">:</span> [ <span class="st">&quot;basketball&quot;</span><span class="op">,</span> <span class="st">&quot;football&quot;</span><span class="op">,</span> <span class="st">&quot;tennis&quot;</span><span class="op">,</span> <span class="st">&quot;rugby&quot;</span> ] <span class="op">}</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcfcf08fd6230c28d817743&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;cassandra&quot;</span><span class="op">,</span> <span class="st">&quot;likes&quot;</span> <span class="op">:</span> [ <span class="st">&quot;golf&quot;</span><span class="op">,</span> <span class="st">&quot;table-tennis&quot;</span><span class="op">,</span> <span class="st">&quot;tennis&quot;</span> ] <span class="op">}</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fcfcf11fd6230c28d817744&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;paul&quot;</span><span class="op">,</span> <span class="st">&quot;likes&quot;</span> <span class="op">:</span> [ <span class="st">&quot;golf&quot;</span><span class="op">,</span> <span class="st">&quot;table-tennis&quot;</span><span class="op">,</span> <span class="st">&quot;tennis&quot;</span><span class="op">,</span> <span class="st">&quot;rugby&quot;</span> ] <span class="op">}</span></span></code></pre></div>
<p>as expected. In these array fields, it is very easy to combine some of the fields let alone one of the field query returning. It becomes extremely useful as time goes by. One operation is <code>\(in</code> which tries to determine whether the values are in the array.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb15-1"><a href="#cb15-1"></a><span class="va">db</span>.<span class="va">scores</span>.<span class="at">find</span>(<span class="op">{</span><span class="dt">a</span><span class="op">:{</span><span class="st">&#39;$in&#39;</span><span class="op">:</span>[<span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">4</span>]<span class="op">}}</span>)</span></code></pre></div>
<p>Another similar and useful operation is <code>exists</code> operation which checks whether the value matches to any value in the database checking every field in the collection. Id’s of documents can also be selected using <code>_id</code> field in the collection as such:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb16-1"><a href="#cb16-1"></a><span class="va">db</span>.<span class="va">matrix</span>.<span class="at">find</span>(<span class="op">{</span><span class="dt">_id</span><span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fd0685b4e0fa619963db3b3&quot;</span>)<span class="op">}</span>)</span></code></pre></div>
<p>and it results in the respective document:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb17-1"><a href="#cb17-1"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fd0685b4e0fa619963db3b3&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Morpheus&quot;</span><span class="op">,</span> <span class="st">&quot;gender&quot;</span> <span class="op">:</span> <span class="st">&quot;m&quot;</span><span class="op">,</span> <span class="st">&quot;age&quot;</span> <span class="op">:</span> <span class="dv">45</span> <span class="op">}</span></span></code></pre></div>
<p>If we have document which have common fields and want to count them, we could do so by using <code>count</code> operation.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb18-1"><a href="#cb18-1"></a><span class="va">db</span>.<span class="va">matrix</span>.<span class="at">count</span>(<span class="op">{</span><span class="dt">name</span><span class="op">:</span> <span class="st">&quot;Morpheus&quot;</span><span class="op">}</span>)</span></code></pre></div>
<p>and it returns 2.(I added the same item twice). If it does not find it, it returns 0 as expected.</p>
<h3 id="removing-queries">Removing Queries</h3>
<p>We could also erase the documents based on their properties as such:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb19-1"><a href="#cb19-1"></a><span class="va">db</span>.<span class="va">matrix</span>.<span class="at">remove</span>(<span class="op">{</span><span class="dt">name</span><span class="op">:</span> <span class="st">&quot;Morpheus&quot;</span><span class="op">}</span>)</span></code></pre></div>
<p>If we want to remove all the entries, we could simply do not give any field information or put <code>null</code> in <code>remove</code> operation:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb20-1"><a href="#cb20-1"></a><span class="va">db</span>.<span class="va">matrix</span>.<span class="at">remove</span>()</span></code></pre></div>
<p>For updates, let’s first create a database in a different syntax:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb21-1"><a href="#cb21-1"></a><span class="va">db</span>.<span class="va">users</span>.<span class="at">save</span>(<span class="op">{</span><span class="dt">name</span><span class="op">:</span> <span class="st">&#39;John&#39;</span><span class="op">,</span> <span class="dt">languages</span><span class="op">:</span> [<span class="st">&#39;ruby&#39;</span><span class="op">,</span> <span class="st">&#39;c&#39;</span><span class="op">,</span><span class="st">&#39;java&#39;</span><span class="op">,</span> <span class="st">&#39;javascript&#39;</span>]<span class="op">}</span>)<span class="op">;</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="va">db</span>.<span class="va">users</span>.<span class="at">save</span>(<span class="op">{</span><span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Sue&#39;</span><span class="op">,</span> <span class="dt">languages</span><span class="op">:</span> [<span class="st">&#39;haskell&#39;</span><span class="op">,</span> <span class="st">&#39;lisp&#39;</span><span class="op">,</span><span class="st">&#39;python&#39;</span><span class="op">,</span><span class="st">&#39;lush&#39;</span>]<span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>In order to update, we need to first select the document based on its one of the field, in this example it would be the names of people and using <code>update()</code> operation, we could update as such:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb22-1"><a href="#cb22-1"></a><span class="va">db</span>.<span class="va">users</span>.<span class="at">update</span>(<span class="op">{</span><span class="dt">name</span><span class="op">:</span> <span class="st">&#39;John&#39;</span><span class="op">},</span> <span class="op">{</span><span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Johnny&#39;</span><span class="op">,</span> <span class="dt">languages</span><span class="op">:</span> [<span class="st">&#39;scala&#39;</span><span class="op">,</span><span class="st">&#39;java&#39;</span><span class="op">,</span><span class="st">&#39;python&#39;</span>]<span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>Instead of updating the entire document, we could update only the fields:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb23-1"><a href="#cb23-1"></a><span class="va">db</span>.<span class="va">users</span>.<span class="at">update</span>(<span class="op">{</span><span class="dt">name</span><span class="op">:</span><span class="st">&#39;Sue&#39;</span><span class="op">},{</span><span class="st">&#39;$set&#39;</span><span class="op">:</span> <span class="op">{</span><span class="dt">age</span><span class="op">:</span><span class="dv">25</span><span class="op">}}</span>)</span></code></pre></div>
<p>And when we try to print out the collection:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb24-1"><a href="#cb24-1"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fd7d5aba46929bd0bbd56f7&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Johnny&quot;</span><span class="op">,</span> <span class="st">&quot;languages&quot;</span> <span class="op">:</span> [ <span class="st">&quot;scala&quot;</span><span class="op">,</span> <span class="st">&quot;java&quot;</span><span class="op">,</span> <span class="st">&quot;python&quot;</span> ] <span class="op">}</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fd7d5ada46929bd0bbd56f8&quot;</span>)<span class="op">,</span> <span class="st">&quot;age&quot;</span> <span class="op">:</span> <span class="dv">25</span><span class="op">,</span> <span class="st">&quot;languages&quot;</span> <span class="op">:</span> [ <span class="st">&quot;scala&quot;</span><span class="op">,</span> <span class="st">&quot;lisp&quot;</span> ]<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Sue&quot;</span> <span class="op">}</span></span></code></pre></div>
<p>In order to update array elements, we could use <code>\(pull</code> and <code>\(push</code> operations. For example, if we want to remove <em>haskell</em> language from Sue’s languages:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb25-1"><a href="#cb25-1"></a><span class="va">db</span>.<span class="va">users</span>.<span class="at">update</span>(<span class="op">{</span><span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Sue&#39;</span><span class="op">},</span> <span class="op">{</span><span class="st">&#39;$pull&#39;</span><span class="op">:</span> <span class="op">{</span><span class="st">&#39;languages&#39;</span><span class="op">:</span> <span class="st">&#39;haskell&#39;</span><span class="op">}</span> <span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>and if we want to add a language say java:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb26-1"><a href="#cb26-1"></a><span class="va">db</span>.<span class="va">users</span>.<span class="at">update</span>(<span class="op">{</span><span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Sue&#39;</span><span class="op">},</span> <span class="op">{</span><span class="st">&#39;$push&#39;</span><span class="op">:</span> <span class="op">{</span><span class="st">&#39;languages&#39;</span><span class="op">:</span> <span class="st">&#39;java&#39;</span><span class="op">}</span> <span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<h3 id="upsertupdate-insert">Upsert(Update + Insert)</h3>
<p>Mongo supports so called <em>upserts</em> which is nothing more than a fancy combination of update and insert. That is, if item that we want to update is not in the collection, it automatically creates it. If it does exist in the collection, it updates by default. However, in order to enable this feature of Mongo, we need to enable the third parameter of <code>update</code> operation as <code>true</code>. Say, we need to create a website hit counter, and in order to do so we increment the number of hits every time the name of website is updated. If we do not have the website name in the collection, we do not have to create it beforehand. We could just use upsert as such:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb27-1"><a href="#cb27-1"></a><span class="va">db</span>.<span class="va">hits</span>.<span class="at">update</span>(<span class="op">{</span><span class="dt">page</span><span class="op">:</span> <span class="st">&#39;yahoo&#39;</span><span class="op">},{</span><span class="dt">$inc</span><span class="op">:</span> <span class="op">{</span><span class="dt">hits</span><span class="op">:</span> <span class="dv">1</span><span class="op">}},</span><span class="kw">true</span>)</span></code></pre></div>
<p>If we do not have the third parameter or set to <code>false</code>, above statement does not change anything in the collection.</p>
<h3 id="multiple-updates">Multiple Updates</h3>
<p>If we want to multiple updates in the collection, we need to enable the fourt parameter in the <code>update</code> operation. For example, we want to reset the counter of websites as such:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb28-1"><a href="#cb28-1"></a><span class="va">db</span>.<span class="va">hits</span>.<span class="at">update</span>(<span class="op">{},{</span><span class="dt">$set</span><span class="op">:</span> <span class="op">{</span><span class="dt">hits</span><span class="op">:</span> <span class="dv">0</span><span class="op">}},</span><span class="kw">false</span><span class="op">,</span><span class="kw">true</span>)</span></code></pre></div>
<p>By doing so, we update all the documents in the collection. However, if we do not enable the fourt parameter as <code>true</code>, then <em>only the first element of the collection will be updated</em>.</p>
<h3 id="deeper-in-find-operation">Deeper in <code>find()</code> operation</h3>
<p>If we want to retrieve specific fields of the documents we could use a second parameter in <code>find()</code>,e.g. only the names of the webpages as such:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb29-1"><a href="#cb29-1"></a><span class="va">db</span>.<span class="va">hits</span>.<span class="at">find</span>(<span class="kw">null</span><span class="op">,{</span><span class="dt">page</span><span class="op">:</span><span class="dv">1</span><span class="op">}</span>)</span></code></pre></div>
<p>then, it results in only page fields of documents, namely <em>google</em> and <em>yahoo</em>.</p>
<h3 id="ordering">Ordering</h3>
<p>Say, we have a database as such:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb30-1"><a href="#cb30-1"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fd8cf5bbd6be5d371385b9a&quot;</span>)<span class="op">,</span> <span class="st">&quot;hits&quot;</span> <span class="op">:</span> <span class="dv">7</span><span class="op">,</span> <span class="st">&quot;page&quot;</span> <span class="op">:</span> <span class="st">&quot;yahoo&quot;</span> <span class="op">}</span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fd8d0fabd6be5d371385b9b&quot;</span>)<span class="op">,</span> <span class="st">&quot;hits&quot;</span> <span class="op">:</span> <span class="dv">5</span><span class="op">,</span> <span class="st">&quot;page&quot;</span> <span class="op">:</span> <span class="st">&quot;google&quot;</span> <span class="op">}</span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fd91925da57fdfbb68d7848&quot;</span>)<span class="op">,</span> <span class="st">&quot;page&quot;</span> <span class="op">:</span> <span class="st">&quot;microsoft&quot;</span><span class="op">,</span> <span class="st">&quot;hits&quot;</span> <span class="op">:</span> <span class="dv">10</span> <span class="op">}</span></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fd91930da57fdfbb68d7849&quot;</span>)<span class="op">,</span> <span class="st">&quot;page&quot;</span> <span class="op">:</span> <span class="st">&quot;facebook&quot;</span><span class="op">,</span> <span class="st">&quot;hits&quot;</span> <span class="op">:</span> <span class="dv">15</span> <span class="op">}</span></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4fd91938da57fdfbb68d784a&quot;</span>)<span class="op">,</span> <span class="st">&quot;page&quot;</span> <span class="op">:</span> <span class="st">&quot;apple&quot;</span><span class="op">,</span> <span class="st">&quot;hits&quot;</span> <span class="op">:</span> <span class="dv">30</span> <span class="op">}</span></span></code></pre></div>
<p>and we want to order this collection by the number of hits in a descending order. We could do this by using <code>sort()</code> operation as such:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb31-1"><a href="#cb31-1"></a><span class="va">db</span>.<span class="va">hits</span>.<span class="at">find</span>().<span class="at">sort</span>(<span class="op">{</span><span class="dt">hits</span><span class="op">:</span> <span class="dv">-1</span><span class="op">}</span>)</span></code></pre></div>
<p>If we want to also return some specific ranks in the sort, we could use <code>limit()</code> and <code>skip()</code> operations. For example, we want to return second and third queries only.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb32-1"><a href="#cb32-1"></a><span class="va">db</span>.<span class="va">hits</span>.<span class="at">find</span>().<span class="at">sort</span>(<span class="op">{</span><span class="dt">hits</span><span class="op">:</span> <span class="dv">-1</span><span class="op">}</span>).<span class="at">limit</span>(<span class="dv">2</span>).<span class="at">skip</span>(<span class="dv">1</span>)</span></code></pre></div>
<h3 id="counting-count">Counting <code>count()</code></h3>
<p><code>count()</code> can be used itself as an independent operation similar to <code>update</code> and <code>insert</code>. However, its origin is to follow <code>find().count()</code>. Therefore, <code>count()</code> operation can be considered as a syntactic sugar for <code>find</code> and <code>count</code>. If we want to count the webpages which have higher than 9 hits;</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb33-1"><a href="#cb33-1"></a><span class="va">db</span>.<span class="va">hits</span>.<span class="at">find</span>(<span class="op">{</span><span class="dt">hits</span><span class="op">:</span> <span class="op">{</span><span class="dt">$gt</span><span class="op">:</span> <span class="dv">9</span><span class="op">}}</span>).<span class="at">count</span>()</span></code></pre></div>
<h3 id="mongodb-difference-and-similarities-to-rdbms">MongoDB Difference and Similarities to RDBMS</h3>
<p>There is no <code>join</code> opearation in Mongo contrary to RDBMS,but we could connect by using a foreign key in the documents of collections. In order to show the embedded and relational part of database, we start with employees example:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb34-1"><a href="#cb34-1"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4d85c7039ab0fd70a117d730&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Paul&quot;</span> <span class="op">}</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4d85c7039ab0fd70a117d731&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Duncan&quot;</span><span class="op">,</span> <span class="st">&quot;manager&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4d85c7039ab0fd70a117d730&quot;</span>) <span class="op">}</span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="op">{</span> <span class="st">&quot;_id&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4d85c7039ab0fd70a117d732&quot;</span>)<span class="op">,</span> <span class="st">&quot;name&quot;</span> <span class="op">:</span> <span class="st">&quot;Moneo&quot;</span><span class="op">,</span> <span class="st">&quot;manager&quot;</span> <span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4d85c7039ab0fd70a117d730&quot;</span>) <span class="op">}</span></span></code></pre></div>
<p>We set Paul as a manager of Duncan and Moneo’s. In the collection, in order to find the manager, we could do as such:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb35-1"><a href="#cb35-1"></a><span class="va">db</span>.<span class="va">employees</span>.<span class="at">find</span>(<span class="op">{</span><span class="dt">manager</span><span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4d85c7039ab0fd70a117d730&quot;</span>)<span class="op">}</span>)</span></code></pre></div>
<p>If we have two managers in the company, then we could add two managers as such:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb36-1"><a href="#cb36-1"></a><span class="va">db</span>.<span class="va">employees</span>.<span class="at">insert</span>(<span class="op">{</span><span class="dt">_id</span><span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4d85c7039ab0fd70a117d733&quot;</span>)<span class="op">,</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Siona&#39;</span><span class="op">,</span><span class="dt">manager</span><span class="op">:</span> [<span class="at">ObjectId</span>(<span class="st">&quot;4d85c7039ab0fd70a117d730&quot;</span>)<span class="op">,</span> <span class="at">ObjectId</span>(<span class="st">&quot;4d85c7039ab0fd70a117d732&quot;</span>)] <span class="op">}</span>)</span></code></pre></div>
<p>We could again return the manager using above operation.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb37-1"><a href="#cb37-1"></a><span class="va">db</span>.<span class="va">employees</span>.<span class="at">find</span>(<span class="op">{</span><span class="dt">manager</span><span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4d85c7039ab0fd70a117d730&quot;</span>)<span class="op">}</span>)</span></code></pre></div>
<p>If we want to embed more documents into the collection like a nested document, we could do so as such:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb38-1"><a href="#cb38-1"></a><span class="va">db</span>.<span class="va">employees</span>.<span class="at">insert</span>(<span class="op">{</span><span class="dt">_id</span><span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4d85c7039ab0fd70a117d734&quot;</span>)<span class="op">,</span> <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Ghanima&#39;</span><span class="op">,</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="dt">family</span><span class="op">:</span> <span class="op">{</span><span class="dt">mother</span><span class="op">:</span> <span class="st">&#39;Chani&#39;</span><span class="op">,</span> <span class="dt">father</span><span class="op">:</span> <span class="st">&#39;Paul&#39;</span><span class="op">,</span> <span class="dt">brother</span><span class="op">:</span> <span class="at">ObjectId</span>(<span class="st">&quot;4d85c7039ab0fd70a117d730&quot;</span>)<span class="op">}}</span>)</span></code></pre></div>
<p>We could return the respective field of the nested document by using <em>dot</em> notation.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb39-1"><a href="#cb39-1"></a><span class="va">db</span>.<span class="va">employees</span>.<span class="at">find</span>(<span class="op">{</span><span class="st">&#39;family.mother&#39;</span><span class="op">:</span> <span class="st">&#39;Chani&#39;</span><span class="op">}</span>)</span></code></pre></div>
<h3 id="mongodb-repair-in-ubuntu">MongoDB Repair in Ubuntu</h3>
<p>First, try to repair.</p>
<pre><code>sudo rm /var/lib/mongodb/mongod.lock
sudo chown -R mongodb:mongodb /var/lib/mongodb/
sudo -u mongodb mongod -f /etc/mongodb.conf --repair
sudo service mongodb start</code></pre>
<p>Then, restart the database.</p>
<pre><code>sudo service mongod start
mongo</code></pre>
</body>
</html>

  
  </article>
  
  </div>
  <div class="thefooter">
    <p>All Rights Reserved
    <br><br>Copyright, <i>2019</i></p>
  </div> <!-- footer end -->
  <script src="/static/js/scramble.js"></script>
  <script>
    emailScramble = new scrambledString(document.getElementById('email'), 'emailScramble', 'dun@euuygbar.', [12, 9, 7, 6, 11, 13, 2, 8, 3, 1, 5, 4, 10]);
  </script>
    <script src="/static/js/logo.js"></script>
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script type="text/javascript">init();</script>
</body>
</html>